# 国旅运通国际机票需求

## 需求迭代功能点

国际机票相关业务：本次改动除了已经上线的退改签的需求外，主要包含2块，一是LLF和9C两种航班的相关信息展示，二是增加行李额的概念和相关逻辑。
菜单我的-出行设置：增加开具电子发票和公司详细信息两个模块，调整12306账号绑定入口显示逻辑。

### 修改点

- 国际机票
入口调整：机票-国际及港澳台，单程和往返按钮显示逻辑调整，只有在intlMode 为 3时显示，即国际产品类型为点对点模式时显示。

- 退改签需求
已上线

- 行李额
  - 核对预订信息页：
    - 选中具体航班后进入价格选择页，退改签按钮和行李额合并两个按钮合并成一个，并且在行李额后动态添加不同仓位级别的行李托运情况标志（3种），将原来退改签和行李额的提示整合进一个popup，Tab切换展示。
    - 差旅人信息确认模块下，增加一行行李额确认栏。逻辑为：REQUIRD_BAGGAGE_FLAG 为 null时不显示，即该变量只要不在白名单，就要显示。该变量有3个值，null为白名单，0为非白名单不需要额外托运行李，1为白名单需要额外托运行李。
    - 接第2条，选中时，更改全局的REQUIRD_BAGGAGE_FLAG的状态。点击查看时，弹框（popup）显示需要托运行李的注意事项：
      - 当前报价中某些航段不包含免费托运行李。如您需要包含免费托运行李的报价，请勾选此选项，后续将有服务人员联系您为您提供更适合的报价方案。
      - 注意：您的服务团队将为您查找同一预订舱位并包括免费托运行李的报价，但最终报价是否可包括免费托运行李将取决于航空公司的运价规定。
    预订之前，增加针对行李额的校验。根据字段bagAllow中是否为0PC（0件）、0K（0千克）来判断该航班是否都包含行李托运，如果有，则弹框（alert）提醒用户：需要托运行李。

  - 订单详情页：
    - 国际航班类型（packageType）为方案+请求模式（REQUEST）时，订单详情增加行李额的入口。
    - 点击行李额按钮，展示行程相关信息，具体查看showBagAllowInfo方法。

### LLF和9C（国内航班）

#### 9C

即春秋航空。因为春秋航空不支持线上退票及改签，所以用户在详情页触发这两个按钮时，进行弹框提醒。逻辑涉及退票、改签、票价显示等相关流程。不具体说明。订单详情中的reBookType（改签类型）字段，有很多针对9C的处理。

#### LLF

LLF，应该是一个航班类型，推断代表系统最低价航班的意思。原有项目已有LLF概念，本次增加以下2点：

- 如果是LLF航班，订单详情页行程下增加LLF航班信息，包含总额、税费，一起查看LLF航班的入口。根据newIntlAirList列表中判断是llfPackage判断。
- 点击查看LLF航班，则弹框（popup）显示该航程每个航段信息及中间换乘时间。intlAir中llfPackage存在时，增加国际航段的弹出窗口（popup）。即国际机票列表newIntlAirList中的第一项信息不为空即可展示该popup。

#### 订单在锁定状态下弹框提醒

从预订国际机票跳转至改详情页，弹框（alert）提醒：”由于该航班座位紧张，预订需求已转入由人工处理，实际价格请以最终确认为准，谢谢。”，该弹框显示必须同时满足以下约束条件：

- 订单状态为待提交时（statusCode为1）
- 国际航班行程锁定（lockFlag为1时）
- 订单的行动代码actionCode时为NotHK

#### 12306账号绑定

入口显示逻辑调整，而不是原来的一直显示。
改为根据配置中的train12306AccountEnable判断，为Y时则显示，其他则不显示。

#### 其他

- 名词
  - PIPL公司是否可以豁免隐私协议
  - 9C 春秋航空

- 字段意思
  - pageageType 国际机票类型
    - NORMAL：国际点对点模式
    - REQUEST： 方案和请求模式
    - reBookType 改签类型
    - null 正常改签
    - involuntary非正常改签